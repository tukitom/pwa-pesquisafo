<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Calculadora de Cores</title>
<link rel="stylesheet" href="styles.css">
<style>
  /* === Estilo isolado da tabela === */
  #tabelaFibra { overflow-x:auto; margin-top:40px; text-align:center; }
  #tabelaFibra table { border-collapse:collapse; margin:auto; box-shadow:0 0 6px rgba(0,0,0,0.1); }
  #tabelaFibra th, #tabelaFibra td {
    border:1px solid #ccc; padding:3px 5px; text-align:center; font-size:11px;
  }
  #tabelaFibra th { background:#fafafa; font-weight:bold; }
  #tabelaFibra .sigla { width:40px; font-weight:bold; background:#000; color:#fff; }
  #btnPDF {
    margin-top:20px; padding:8px 14px; border:none; background:#222; color:#fff;
    border-radius:6px; cursor:pointer; font-size:13px;
  }
  #btnPDF:hover { background:#444; }
  @media (max-width:800px){
    #tabelaFibra table { font-size:9px; }
    #tabelaFibra th, #tabelaFibra td { padding:2px; }
  }
</style>
</head>
<body>
<header>
  <nav>
    <button onclick="window.location.href='index.html'">üè† In√≠cio</button>
    <button onclick="window.location.href='app.html'">üìÇ CSV</button>
    <button onclick="window.location.href='calculadora.html'">üé® Calculadora</button>
    <button onclick="window.location.href='mapa.html'">üó∫Ô∏è Mapa</button>
  </nav>
</header>

<main style="text-align:center;padding:20px;">
  <h2>Calculadora de Cores</h2>
  <input id="editFibra" type="number" placeholder="N√∫mero da Fibra (1-288)" min="1" max="288">
  <button id="btnCalcularCor">Calcular</button>
  <div id="textCorResult" style="margin-top:20px;"></div>

  <h3 style="margin-top:40px;">Tabela de Identifica√ß√£o de Fibras √ìpticas (1‚Äì288)</h3>
  <div id="tabelaFibra"></div>
  <button id="btnPDF">üìÑ Exportar PDF</button>
</main>

<!-- jsPDF para exportar -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<script>
// === CALCULADORA (igual √† sua original) ===
document.getElementById("btnCalcularCor").onclick = () => {
  const numero = parseInt(document.getElementById("editFibra").value);
  if (!numero || numero < 1 || numero > 288) {
    alert("Insira um n√∫mero v√°lido (1-288).");
    return;
  }
  const fibraColors = {
    1:"#FFFFFF",2:"#FF0000",3:"#00FF00",4:"#0000FF",5:"#000000",6:"#FFFF00",
    7:"#FFA500",8:"#808080",9:"#8B4513",10:"#800080",11:"#FFC0CB",12:"#40E0D0"
  };
  const corIndexFibra = ((numero - 1) % 12) + 1;
  const corFibra = fibraColors[corIndexFibra];
  const tubo = Math.floor((numero - 1) / 12) + 1;
  const corTubo = fibraColors[((tubo - 1) % 12) + 1];
  document.getElementById("textCorResult").innerHTML =
    `Fibra ${numero}: <font color='${corFibra}'>‚óè</font> &nbsp; Tubo ${tubo}: <font color='${corTubo}'>‚óè</font>`;
};

// === TABELA COLORIDA ===
const cores = [
  ["Branco","#FFFFFF","BR"],
  ["Vermelho","#FF0000","VM"],
  ["Verde","#00FF00","VD"],
  ["Azul","#0000FF","AZ"],
  ["Preto","#000000","PR"],
  ["Amarelo","#FFFF00","AM"],
  ["Laranja","#FFA500","LR"],
  ["Cinza","#808080","CZ"],
  ["Marrom","#8B4513","CT"],
  ["Violeta","#800080","VT"],
  ["Rosa","#FFC0CB","RS"],
  ["Turquesa","#40E0D0","TQ"]
];

function gerarTabela(){
  let html = `<table><thead><tr><th class='sigla'>Sigla</th>`;
  // Cabe√ßalho colorido (1‚Äì24)
  for(let t=1;t<=24;t++){
    const corTubo = cores[(t-1)%12][1];
    const textColor = ["#000000","#8B4513","#800080","#808080","#0000FF","#FF0000"].includes(corTubo) ? "#fff" : "#000";
    html += `<th style="background:${corTubo};color:${textColor}">${t}</th>`;
  }
  html += `</tr></thead><tbody>`;

  // Linhas coloridas (cada fibra)
  for(let f=0;f<12;f++){
    const [_, corFibra, sigla] = cores[f];
    html += `<tr><td class='sigla'>${sigla}</td>`;
    for(let t=1;t<=24;t++){
      const numero = (t - 1) * 12 + (f + 1);
      const textColor = ["#000000","#8B4513","#800080","#808080","#0000FF","#FF0000"].includes(corFibra) ? "#fff" : "#000";
      html += `<td style="background:${corFibra};color:${textColor}">${numero}</td>`;
    }
    html += `</tr>`;
  }
  html += `</tbody></table>`;
  document.getElementById("tabelaFibra").innerHTML = html;
}
gerarTabela();

// === EXPORTAR PARA PDF ===
document.getElementById("btnPDF").addEventListener("click", async () => {
  const { jsPDF } = window.jspdf;
  const tabela = document.getElementById("tabelaFibra");
  const canvas = await html2canvas(tabela);
  const imgData = canvas.toDataURL("image/png");
  const pdf = new jsPDF({ orientation: "landscape", unit: "pt", format: "a4" });
  const pageWidth = pdf.internal.pageSize.getWidth();
  const pageHeight = pdf.internal.pageSize.getHeight();
  const imgWidth = pageWidth - 40;
  const imgHeight = (canvas.height * imgWidth) / canvas.width;
  pdf.addImage(imgData, "PNG", 20, 20, imgWidth, imgHeight);
  pdf.save("Tabela_Fibras_Opticas.pdf");
});
</script>
</body>
</html>
